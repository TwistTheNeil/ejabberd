 1) Ejabberd 1.1.2 changed error message, which is sent if the server
    doesn't understand received query, from <feature-not-implemented/>
    to <service-unavailable>. While it's recommended by XMPP RFC, it
    breaks some Jabber clients (centericq is known to fail after the
    change). The patch restores old error message.

Index: ejabberd/src/ejabberd_sm.erl
===================================================================
--- ejabberd.orig/src/ejabberd_sm.erl
+++ ejabberd/src/ejabberd_sm.erl
@@ -555,7 +555,7 @@
 					  From, To, IQ);
 		[] ->
 		    Err = jlib:make_error_reply(
-			    Packet, ?ERR_SERVICE_UNAVAILABLE),
+			    Packet, ?ERR_FEATURE_NOT_IMPLEMENTED),
 		    ejabberd_router:route(To, From, Err)
 	    end;
 	reply ->
